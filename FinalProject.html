<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Vinny Chloros">
<meta name="dcterms.date" content="2025-04-02">

<title>Predicting Codon Usage Across Taxa</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="FinalProject_files/libs/clipboard/clipboard.min.js"></script>
<script src="FinalProject_files/libs/quarto-html/quarto.js"></script>
<script src="FinalProject_files/libs/quarto-html/popper.min.js"></script>
<script src="FinalProject_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="FinalProject_files/libs/quarto-html/anchor.min.js"></script>
<link href="FinalProject_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="FinalProject_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="FinalProject_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="FinalProject_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="FinalProject_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">

<script src="FinalProject_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="FinalProject_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Predicting Codon Usage Across Taxa</h1>
                      </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Vinny Chloros </p>
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Southern New Hampshire University
            </p>
        </div>
      </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 2, 2025</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">April 28, 2025</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#statement-of-purpose" id="toc-statement-of-purpose" class="nav-link active" data-scroll-target="#statement-of-purpose">Statement of Purpose</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#single-variables" id="toc-single-variables" class="nav-link" data-scroll-target="#single-variables">Single Variables</a></li>
  <li><a href="#multiple-variables" id="toc-multiple-variables" class="nav-link" data-scroll-target="#multiple-variables">Multiple Variables</a></li>
  </ul></li>
  <li><a href="#model-building" id="toc-model-building" class="nav-link" data-scroll-target="#model-building">Model Building</a>
  <ul class="collapse">
  <li><a href="#knn" id="toc-knn" class="nav-link" data-scroll-target="#knn">KNN</a></li>
  <li><a href="#dt" id="toc-dt" class="nav-link" data-scroll-target="#dt">DT</a></li>
  <li><a href="#random-trees" id="toc-random-trees" class="nav-link" data-scroll-target="#random-trees">Random Trees</a></li>
  <li><a href="#support-vector-machine-model" id="toc-support-vector-machine-model" class="nav-link" data-scroll-target="#support-vector-machine-model">Support Vector Machine Model</a></li>
  </ul></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusions</a></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">




<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parsnip)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ranger)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(discrim)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kernlab)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"codon_usage.csv"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>unregister <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  env <span class="ot">&lt;-</span> foreach<span class="sc">:::</span>.foreachGlobals</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>(<span class="at">name=</span>env), <span class="at">pos=</span>env)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20250402</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">DNAtype =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>      DNAtype <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"genomic"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>      DNAtype <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"mitochondrial"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>      DNAtype <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"chloroplast"</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>      DNAtype <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"cyanelle"</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>      DNAtype <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"plastid"</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>      DNAtype <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"nucleomorph"</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>      DNAtype <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">"secondary_endosymbiont"</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>      DNAtype <span class="sc">==</span> <span class="dv">7</span> <span class="sc">~</span> <span class="st">"chromoplast"</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>      DNAtype <span class="sc">==</span> <span class="dv">8</span> <span class="sc">~</span> <span class="st">"leucoplast"</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>      DNAtype <span class="sc">==</span> <span class="dv">9</span> <span class="sc">~</span> <span class="st">"NA"</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>      DNAtype <span class="sc">==</span> <span class="dv">10</span> <span class="sc">~</span> <span class="st">"proplastid"</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>      DNAtype <span class="sc">==</span> <span class="dv">11</span> <span class="sc">~</span> <span class="st">"apicoplast"</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>      DNAtype <span class="sc">==</span> <span class="dv">12</span> <span class="sc">~</span> <span class="st">"kinetoplast"</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"unknown"</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(data, <span class="at">strata =</span> Kingdom)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">training</span>(split)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">testing</span>(split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="statement-of-purpose" class="level2">
<h2 class="anchored" data-anchor-id="statement-of-purpose">Statement of Purpose</h2>
<p>Codons are vital to our understanding of amino acids and protein production within living organisms. The codons used for certain proteins vary in both presence and frequency between different organisms and, on a larger scale, between taxa. By analyzing and predicting the relationship between codon frequency and the organization of different organisms, insights can be formed about how codons differ between groups and what changes might have occurred throughout evolutionary history in terms of genetic variation and protein building.</p>
</section>
<section id="introduction" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>A codon is a collection of 3 nucleotides (A, C, G, or U for RNA) within a genetic sequence. Different codons call for the production of amino acids which build proteins. The order of codons determine the order of amino acid production and, subsequently, the form and function of the resulting protein. There are 64 different combinations possible with 4 nucleotides in 3 positions, but there are only around 20 amino acids that are commonly produced from these combinations.</p>
<div class="column-body-outset-right">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="codon_img.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Table of amino acid production based on nucleotide position</figcaption>
</figure>
</div>
<p>Above is a table showing what amino acids are produced based of the position of different nucleotides throughout the a codon <span class="citation" data-cites="openstax">(<a href="#ref-openstax" role="doc-biblioref">Clark, Douglas, and Choi 2018</a>)</span>. Some codons, especially those with the same nucleotides in the first or second position, will produce the same amino acid.</p>
<p>Since proteins utilize long strings of amino acids and have an incredible amount of variation, codons can differ in how often they appear within a genome. Based on differing usage between taxa, variation between frequency could be correlated to evolutionary divergence. For instance, a codon with a very small frequency in an ancestral taxa might display increased prevalence in descendant. From there, one could infer how that increased frequency came to be. For instance, maybe the protein it is a part of was vital to a new trait and became more prevalent due to natural selection.</p>
<p>By making predictions through classification models, we can observe if and how the models distinguish different taxa through this codon data. From there, further investigations can be conducted to identify individual codons that are most associated with particular taxa and serve as the primary indicator of different groups.</p>
</div>
</section>
<section id="exploratory-data-analysis" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis">Exploratory Data Analysis</h2>
<p>This data set has 69 total variables: Kingdom, DNAtype, SpeciesID, Ncodons, SpeciesName, and 64 unique codons. Each codon variable contains its frequency across different species. The first 5 variables are categorical while the codon frequencies for the other 64 are all numerical. In investigating these variables and later model building, SpeciesID and SpeciesName will be excluded since each value is unique to an observation and would hinder later predictions.</p>
<section id="single-variables" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="single-variables">Single Variables</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> Kingdom)) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Count of Codons Between Kingdoms"</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Kingdom"</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Kingdom) <span class="sc">|&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Kingdom</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">arc</td>
<td style="text-align: right;">92</td>
</tr>
<tr class="even">
<td style="text-align: left;">bct</td>
<td style="text-align: right;">2190</td>
</tr>
<tr class="odd">
<td style="text-align: left;">inv</td>
<td style="text-align: right;">1014</td>
</tr>
<tr class="even">
<td style="text-align: left;">mam</td>
<td style="text-align: right;">427</td>
</tr>
<tr class="odd">
<td style="text-align: left;">phg</td>
<td style="text-align: right;">172</td>
</tr>
<tr class="even">
<td style="text-align: left;">plm</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pln</td>
<td style="text-align: right;">1875</td>
</tr>
<tr class="even">
<td style="text-align: left;">pri</td>
<td style="text-align: right;">130</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rod</td>
<td style="text-align: right;">165</td>
</tr>
<tr class="even">
<td style="text-align: left;">vrl</td>
<td style="text-align: right;">2131</td>
</tr>
<tr class="odd">
<td style="text-align: left;">vrt</td>
<td style="text-align: right;">1558</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The data set features 11 different groups titled kingdoms: archaea (arc), bacteria (bct), invertbrates (inv), mammals (mam), bacteriophages (phg), plasmid (plm), plants (pln), primates (pri), rodents (rod), viruses (vrl), and vertebrates (vrt). Note that these categories don’t represent actual kingdoms, of which there are only 7. Groups like primates and rodents are orders and are included within both mammals and vertebrates. Similarly, bacteriophages are a type of virus and thus would typically be classified as such. It seems like Kingdom as a category is simply used to describe large groups that species are classified by rather than actual biological kingdoms.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> DNAtype)) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Count of DNA types"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Count"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"DNA Type"</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(DNAtype) <span class="sc">|&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">DNAtype</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">apicoplast</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">chloroplast</td>
<td style="text-align: right;">612</td>
</tr>
<tr class="even">
<td style="text-align: left;">chromoplast</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cyanelle</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">genomic</td>
<td style="text-align: right;">6970</td>
</tr>
<tr class="odd">
<td style="text-align: left;">kinetoplast</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">mitochondrial</td>
<td style="text-align: right;">2154</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nucleomorph</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">plastid</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">secondary_endosymbiont</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>By a wide margin, it seems like genomic data is the most prevalent source of codons in the data set, followed by mitochondrial and chloroplast DNA. Most organisms have a primary genome while most eukaryotes (multicellular organisms) have mitochondiral DNA, explaining the frequency of these groups. Plants are another group included in this analysis, and alongside mitochondria, they also have chloroplasts that hold unique DNA. Plastids are common forms of “extra” DNA that certain bacteria are known to uptake and incorporate into their larger genome, so it makes sense that these are also present, although limited in number. Other forms of genetic information are rare in most organisms and therefore take up a very small proportion of the data.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In this data, the codons are using U, or Uracil, as one of their nucleotides which is specific to RNA. Despite that, the categories here are called DNAtype. This is because, through <em>transcription</em>, DNA in an organism is taken and used to create RNA that is later <em>translated</em> into proteins. Even though they are different steps in the process, they convey the same information.</p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>DNAtype <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"genomic"</span>, <span class="st">"chloroplast"</span>, <span class="st">"mitochondrial"</span>, <span class="st">"plastid"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">|&gt;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Kingdom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DNAtype</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SpeciesID</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ncodons</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">SpeciesName</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">UUU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">UUC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">UUA</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">UUG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CUU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CUC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CUA</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CUG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AUU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AUC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AUA</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AUG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GUU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GUC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GUA</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GUG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GCU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GCC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GCA</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GCG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CCU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CCC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CCA</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CCG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">UGG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GGU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GGC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GGA</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GGG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">UCU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">UCC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">UCA</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">UCG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AGU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AGC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ACU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ACC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ACA</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ACG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">UAU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">UAC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CAA</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CAG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AAU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AAC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">UGU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">UGC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CAU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CAC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AAA</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AAG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CGU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CGC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CGA</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CGG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AGA</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AGG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GAU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GAC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GAA</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GAG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">UAA</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">UAG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">UGA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">bct</td>
<td style="text-align: left;">secondary_endosymbiont</td>
<td style="text-align: right;">229112</td>
<td style="text-align: right;">4448</td>
<td style="text-align: left;">secondary endosymbiont of Bemisia tabaci</td>
<td style="text-align: right;">0.01102</td>
<td style="text-align: right;">0.00022</td>
<td style="text-align: right;">0.03350</td>
<td style="text-align: right;">0.01102</td>
<td style="text-align: right;">0.00540</td>
<td style="text-align: right;">0.00360</td>
<td style="text-align: right;">0.00202</td>
<td style="text-align: right;">0.01079</td>
<td style="text-align: right;">0.04294</td>
<td style="text-align: right;">0.02338</td>
<td style="text-align: right;">0.01079</td>
<td style="text-align: right;">0.04114</td>
<td style="text-align: right;">0.02698</td>
<td style="text-align: right;">0.02518</td>
<td style="text-align: right;">0.01259</td>
<td style="text-align: right;">0.02653</td>
<td style="text-align: right;">0.03058</td>
<td style="text-align: right;">0.02338</td>
<td style="text-align: right;">0.05193</td>
<td style="text-align: right;">0.00944</td>
<td style="text-align: right;">0.01326</td>
<td style="text-align: right;">0.00180</td>
<td style="text-align: right;">0.00382</td>
<td style="text-align: right;">0.00540</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.03777</td>
<td style="text-align: right;">0.02181</td>
<td style="text-align: right;">0.02743</td>
<td style="text-align: right;">0.00944</td>
<td style="text-align: right;">0.03507</td>
<td style="text-align: right;">0.00540</td>
<td style="text-align: right;">0.00517</td>
<td style="text-align: right;">0.00180</td>
<td style="text-align: right;">0.00202</td>
<td style="text-align: right;">0.00360</td>
<td style="text-align: right;">0.02001</td>
<td style="text-align: right;">0.01461</td>
<td style="text-align: right;">0.00899</td>
<td style="text-align: right;">0.00562</td>
<td style="text-align: right;">0.01259</td>
<td style="text-align: right;">0.00360</td>
<td style="text-align: right;">0.01439</td>
<td style="text-align: right;">0.01102</td>
<td style="text-align: right;">0.03035</td>
<td style="text-align: right;">0.01776</td>
<td style="text-align: right;">0.00202</td>
<td style="text-align: right;">0.00180</td>
<td style="text-align: right;">0.00180</td>
<td style="text-align: right;">0.00180</td>
<td style="text-align: right;">0.07104</td>
<td style="text-align: right;">0.02406</td>
<td style="text-align: right;">0.01776</td>
<td style="text-align: right;">0.00899</td>
<td style="text-align: right;">0.00180</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.00540</td>
<td style="text-align: right;">0.00180</td>
<td style="text-align: right;">0.03777</td>
<td style="text-align: right;">0.02316</td>
<td style="text-align: right;">0.06924</td>
<td style="text-align: right;">0.01461</td>
<td style="text-align: right;">0.00180</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.00000</td>
</tr>
<tr class="even">
<td style="text-align: left;">inv</td>
<td style="text-align: left;">apicoplast</td>
<td style="text-align: right;">126793</td>
<td style="text-align: right;">1805</td>
<td style="text-align: left;">apicoplast Plasmodium vivax</td>
<td style="text-align: right;">0.04931</td>
<td style="text-align: right;">0.00222</td>
<td style="text-align: right;">0.10748</td>
<td style="text-align: right;">0.00222</td>
<td style="text-align: right;">0.00055</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.00166</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.06205</td>
<td style="text-align: right;">0.00332</td>
<td style="text-align: right;">0.09252</td>
<td style="text-align: right;">0.01773</td>
<td style="text-align: right;">0.01053</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.01994</td>
<td style="text-align: right;">0.00166</td>
<td style="text-align: right;">0.01330</td>
<td style="text-align: right;">0.00055</td>
<td style="text-align: right;">0.00554</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.01773</td>
<td style="text-align: right;">0.00222</td>
<td style="text-align: right;">0.00499</td>
<td style="text-align: right;">0.00111</td>
<td style="text-align: right;">0.00499</td>
<td style="text-align: right;">0.02604</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.02659</td>
<td style="text-align: right;">0.00332</td>
<td style="text-align: right;">0.02382</td>
<td style="text-align: right;">0.00055</td>
<td style="text-align: right;">0.01496</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.00831</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.02105</td>
<td style="text-align: right;">0.00166</td>
<td style="text-align: right;">0.02548</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.05208</td>
<td style="text-align: right;">0.00166</td>
<td style="text-align: right;">0.02493</td>
<td style="text-align: right;">0.00332</td>
<td style="text-align: right;">0.10859</td>
<td style="text-align: right;">0.00111</td>
<td style="text-align: right;">0.00831</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.02382</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.08864</td>
<td style="text-align: right;">0.00332</td>
<td style="text-align: right;">0.00443</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.00166</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.01330</td>
<td style="text-align: right;">0.00720</td>
<td style="text-align: right;">0.03047</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.04931</td>
<td style="text-align: right;">0.00222</td>
<td style="text-align: right;">0.00222</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.00000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">inv</td>
<td style="text-align: left;">kinetoplast</td>
<td style="text-align: right;">5691</td>
<td style="text-align: right;">5407</td>
<td style="text-align: left;">kinetoplast Trypanosoma brucei</td>
<td style="text-align: right;">0.11910</td>
<td style="text-align: right;">0.01110</td>
<td style="text-align: right;">0.06418</td>
<td style="text-align: right;">0.05215</td>
<td style="text-align: right;">0.01332</td>
<td style="text-align: right;">0.00684</td>
<td style="text-align: right;">0.00647</td>
<td style="text-align: right;">0.00888</td>
<td style="text-align: right;">0.03440</td>
<td style="text-align: right;">0.01017</td>
<td style="text-align: right;">0.04439</td>
<td style="text-align: right;">0.03348</td>
<td style="text-align: right;">0.03532</td>
<td style="text-align: right;">0.00259</td>
<td style="text-align: right;">0.02016</td>
<td style="text-align: right;">0.01443</td>
<td style="text-align: right;">0.01350</td>
<td style="text-align: right;">0.00536</td>
<td style="text-align: right;">0.01147</td>
<td style="text-align: right;">0.00869</td>
<td style="text-align: right;">0.00555</td>
<td style="text-align: right;">0.00481</td>
<td style="text-align: right;">0.00555</td>
<td style="text-align: right;">0.00407</td>
<td style="text-align: right;">0.00740</td>
<td style="text-align: right;">0.03514</td>
<td style="text-align: right;">0.00610</td>
<td style="text-align: right;">0.01295</td>
<td style="text-align: right;">0.00758</td>
<td style="text-align: right;">0.01128</td>
<td style="text-align: right;">0.00351</td>
<td style="text-align: right;">0.01313</td>
<td style="text-align: right;">0.00314</td>
<td style="text-align: right;">0.02016</td>
<td style="text-align: right;">0.00795</td>
<td style="text-align: right;">0.00721</td>
<td style="text-align: right;">0.00314</td>
<td style="text-align: right;">0.01387</td>
<td style="text-align: right;">0.00573</td>
<td style="text-align: right;">0.04124</td>
<td style="text-align: right;">0.00851</td>
<td style="text-align: right;">0.00462</td>
<td style="text-align: right;">0.00629</td>
<td style="text-align: right;">0.02053</td>
<td style="text-align: right;">0.00851</td>
<td style="text-align: right;">0.04494</td>
<td style="text-align: right;">0.00740</td>
<td style="text-align: right;">0.01110</td>
<td style="text-align: right;">0.00481</td>
<td style="text-align: right;">0.01609</td>
<td style="text-align: right;">0.01831</td>
<td style="text-align: right;">0.00943</td>
<td style="text-align: right;">0.00296</td>
<td style="text-align: right;">0.00425</td>
<td style="text-align: right;">0.00277</td>
<td style="text-align: right;">0.00647</td>
<td style="text-align: right;">0.00407</td>
<td style="text-align: right;">0.02830</td>
<td style="text-align: right;">0.00740</td>
<td style="text-align: right;">0.01757</td>
<td style="text-align: right;">0.01554</td>
<td style="text-align: right;">0.00203</td>
<td style="text-align: right;">0.00111</td>
<td style="text-align: right;">0.01147</td>
</tr>
<tr class="even">
<td style="text-align: left;">inv</td>
<td style="text-align: left;">kinetoplast</td>
<td style="text-align: right;">5692</td>
<td style="text-align: right;">1440</td>
<td style="text-align: left;">kinetoplast Trypanosoma congolense</td>
<td style="text-align: right;">0.02986</td>
<td style="text-align: right;">0.01319</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.01250</td>
<td style="text-align: right;">0.01736</td>
<td style="text-align: right;">0.01319</td>
<td style="text-align: right;">0.00208</td>
<td style="text-align: right;">0.02500</td>
<td style="text-align: right;">0.02431</td>
<td style="text-align: right;">0.01736</td>
<td style="text-align: right;">0.00694</td>
<td style="text-align: right;">0.02361</td>
<td style="text-align: right;">0.01944</td>
<td style="text-align: right;">0.01597</td>
<td style="text-align: right;">0.00278</td>
<td style="text-align: right;">0.03403</td>
<td style="text-align: right;">0.01667</td>
<td style="text-align: right;">0.01389</td>
<td style="text-align: right;">0.01597</td>
<td style="text-align: right;">0.01875</td>
<td style="text-align: right;">0.00764</td>
<td style="text-align: right;">0.01181</td>
<td style="text-align: right;">0.00694</td>
<td style="text-align: right;">0.01736</td>
<td style="text-align: right;">0.00972</td>
<td style="text-align: right;">0.02083</td>
<td style="text-align: right;">0.01806</td>
<td style="text-align: right;">0.01250</td>
<td style="text-align: right;">0.01528</td>
<td style="text-align: right;">0.01042</td>
<td style="text-align: right;">0.00972</td>
<td style="text-align: right;">0.00625</td>
<td style="text-align: right;">0.01597</td>
<td style="text-align: right;">0.00903</td>
<td style="text-align: right;">0.00903</td>
<td style="text-align: right;">0.00972</td>
<td style="text-align: right;">0.01181</td>
<td style="text-align: right;">0.01667</td>
<td style="text-align: right;">0.01528</td>
<td style="text-align: right;">0.01181</td>
<td style="text-align: right;">0.02222</td>
<td style="text-align: right;">0.00625</td>
<td style="text-align: right;">0.02569</td>
<td style="text-align: right;">0.01111</td>
<td style="text-align: right;">0.03056</td>
<td style="text-align: right;">0.00625</td>
<td style="text-align: right;">0.00764</td>
<td style="text-align: right;">0.00694</td>
<td style="text-align: right;">0.01250</td>
<td style="text-align: right;">0.01528</td>
<td style="text-align: right;">0.05694</td>
<td style="text-align: right;">0.02014</td>
<td style="text-align: right;">0.02014</td>
<td style="text-align: right;">0.00556</td>
<td style="text-align: right;">0.01667</td>
<td style="text-align: right;">0.00417</td>
<td style="text-align: right;">0.00833</td>
<td style="text-align: right;">0.03542</td>
<td style="text-align: right;">0.04028</td>
<td style="text-align: right;">0.02569</td>
<td style="text-align: right;">0.05278</td>
<td style="text-align: right;">0.00069</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.00000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">inv</td>
<td style="text-align: left;">kinetoplast</td>
<td style="text-align: right;">75058</td>
<td style="text-align: right;">2367</td>
<td style="text-align: left;">kinetoplast Bodo saltans</td>
<td style="text-align: right;">0.07182</td>
<td style="text-align: right;">0.02577</td>
<td style="text-align: right;">0.03591</td>
<td style="text-align: right;">0.02281</td>
<td style="text-align: right;">0.02493</td>
<td style="text-align: right;">0.01563</td>
<td style="text-align: right;">0.01479</td>
<td style="text-align: right;">0.01310</td>
<td style="text-align: right;">0.03929</td>
<td style="text-align: right;">0.01479</td>
<td style="text-align: right;">0.02070</td>
<td style="text-align: right;">0.02577</td>
<td style="text-align: right;">0.02619</td>
<td style="text-align: right;">0.02028</td>
<td style="text-align: right;">0.01563</td>
<td style="text-align: right;">0.01817</td>
<td style="text-align: right;">0.01563</td>
<td style="text-align: right;">0.00718</td>
<td style="text-align: right;">0.01732</td>
<td style="text-align: right;">0.01436</td>
<td style="text-align: right;">0.00803</td>
<td style="text-align: right;">0.00465</td>
<td style="text-align: right;">0.00718</td>
<td style="text-align: right;">0.01014</td>
<td style="text-align: right;">0.00718</td>
<td style="text-align: right;">0.02028</td>
<td style="text-align: right;">0.00972</td>
<td style="text-align: right;">0.01436</td>
<td style="text-align: right;">0.00803</td>
<td style="text-align: right;">0.01352</td>
<td style="text-align: right;">0.00718</td>
<td style="text-align: right;">0.01859</td>
<td style="text-align: right;">0.01225</td>
<td style="text-align: right;">0.01605</td>
<td style="text-align: right;">0.01056</td>
<td style="text-align: right;">0.01479</td>
<td style="text-align: right;">0.01141</td>
<td style="text-align: right;">0.01732</td>
<td style="text-align: right;">0.01014</td>
<td style="text-align: right;">0.02028</td>
<td style="text-align: right;">0.01563</td>
<td style="text-align: right;">0.01563</td>
<td style="text-align: right;">0.01014</td>
<td style="text-align: right;">0.02450</td>
<td style="text-align: right;">0.01605</td>
<td style="text-align: right;">0.01732</td>
<td style="text-align: right;">0.00845</td>
<td style="text-align: right;">0.01098</td>
<td style="text-align: right;">0.01098</td>
<td style="text-align: right;">0.01563</td>
<td style="text-align: right;">0.02366</td>
<td style="text-align: right;">0.00803</td>
<td style="text-align: right;">0.00718</td>
<td style="text-align: right;">0.01098</td>
<td style="text-align: right;">0.00422</td>
<td style="text-align: right;">0.00591</td>
<td style="text-align: right;">0.00127</td>
<td style="text-align: right;">0.02577</td>
<td style="text-align: right;">0.01817</td>
<td style="text-align: right;">0.02112</td>
<td style="text-align: right;">0.01690</td>
<td style="text-align: right;">0.00084</td>
<td style="text-align: right;">0.00084</td>
<td style="text-align: right;">0.00803</td>
</tr>
<tr class="even">
<td style="text-align: left;">pln</td>
<td style="text-align: left;">cyanelle</td>
<td style="text-align: right;">2762</td>
<td style="text-align: right;">38694</td>
<td style="text-align: left;">cyanelle Cyanophora paradoxa</td>
<td style="text-align: right;">0.03409</td>
<td style="text-align: right;">0.01010</td>
<td style="text-align: right;">0.08094</td>
<td style="text-align: right;">0.00367</td>
<td style="text-align: right;">0.01476</td>
<td style="text-align: right;">0.00106</td>
<td style="text-align: right;">0.00535</td>
<td style="text-align: right;">0.00090</td>
<td style="text-align: right;">0.06812</td>
<td style="text-align: right;">0.00793</td>
<td style="text-align: right;">0.01145</td>
<td style="text-align: right;">0.01959</td>
<td style="text-align: right;">0.03445</td>
<td style="text-align: right;">0.00209</td>
<td style="text-align: right;">0.02484</td>
<td style="text-align: right;">0.00253</td>
<td style="text-align: right;">0.03316</td>
<td style="text-align: right;">0.00336</td>
<td style="text-align: right;">0.03199</td>
<td style="text-align: right;">0.00445</td>
<td style="text-align: right;">0.01471</td>
<td style="text-align: right;">0.00140</td>
<td style="text-align: right;">0.01974</td>
<td style="text-align: right;">0.00305</td>
<td style="text-align: right;">0.01029</td>
<td style="text-align: right;">0.03616</td>
<td style="text-align: right;">0.00522</td>
<td style="text-align: right;">0.02220</td>
<td style="text-align: right;">0.00349</td>
<td style="text-align: right;">0.02424</td>
<td style="text-align: right;">0.00525</td>
<td style="text-align: right;">0.01137</td>
<td style="text-align: right;">0.00183</td>
<td style="text-align: right;">0.01695</td>
<td style="text-align: right;">0.00308</td>
<td style="text-align: right;">0.02845</td>
<td style="text-align: right;">0.00548</td>
<td style="text-align: right;">0.01980</td>
<td style="text-align: right;">0.00320</td>
<td style="text-align: right;">0.02605</td>
<td style="text-align: right;">0.00514</td>
<td style="text-align: right;">0.03905</td>
<td style="text-align: right;">0.00261</td>
<td style="text-align: right;">0.04016</td>
<td style="text-align: right;">0.00724</td>
<td style="text-align: right;">0.00845</td>
<td style="text-align: right;">0.00101</td>
<td style="text-align: right;">0.01256</td>
<td style="text-align: right;">0.00315</td>
<td style="text-align: right;">0.05975</td>
<td style="text-align: right;">0.00566</td>
<td style="text-align: right;">0.02729</td>
<td style="text-align: right;">0.00411</td>
<td style="text-align: right;">0.00985</td>
<td style="text-align: right;">0.00072</td>
<td style="text-align: right;">0.00938</td>
<td style="text-align: right;">0.00047</td>
<td style="text-align: right;">0.03463</td>
<td style="text-align: right;">0.00581</td>
<td style="text-align: right;">0.05637</td>
<td style="text-align: right;">0.00478</td>
<td style="text-align: right;">0.00421</td>
<td style="text-align: right;">0.00067</td>
<td style="text-align: right;">0.00013</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Based on a small peak at some of smaller DNA types within the data, it seems like most of these instances were extracted from microbes. Instances like the cyanelle, kinetoplast, and apicoplast seem to be organelles that, similar to mitochondria, have their own genetic information <span class="citation" data-cites="apicoplast kinetoplast">(<a href="#ref-apicoplast" role="doc-biblioref">Parada 2010b</a>, <a href="#ref-kinetoplast" role="doc-biblioref">2010a</a>)</span>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> Ncodons)) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Number of Codons in all Samples"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Number of Codons"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>Ncodons <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
    1000     1603     2943    80496     9083 34132283 </code></pre>
</div>
</div>
<p>The total number of codons for each organism varies throughout the data set. Most are between 1,500 and 10,000 codons, but some exceed this average range by a wide margin; the observation with the highest number of codons has over 30,000,000.</p>
<p>Since there are 64 different codons within the data, I isolated a few to serve as examples for distribution in this section of the analysis. These are UUU, CGU, AUG, and UAG. AUG and UAG are of particular interest because they are start and stop codons, respectively. AUG indicates the beginning of a protein-making sequence while UAG ends the process of translating RNA to call for amino acids.</p>
<div class="page-columns page-full">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> UUU)) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"UUU Frequency"</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Usage Frequency"</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> CGU)) <span class="sc">+</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"CGU Frequency"</span>,</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Usage Frequency"</span>,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> AUG)) <span class="sc">+</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"AUG Frequency"</span>,</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Usage Frequency"</span>,</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> UAG)) <span class="sc">+</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"UAG Frequency"</span>,</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Usage Frequency"</span>,</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell column-screen-inset-shaded quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-7-4.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<p>From this sample, we can see that there is a fair amount of variation between different codons and their usage frequency. For the codon UUU, most of it’s distributions are between 0 and 0.05 with much fewer instances landing near 0.20 or beyond. CGU has a smaller frequency, typically between 0 and 0.02 with the largest being only just beyond 0.06.</p>
<p>AUG was far more common with frequencies largely between 0 and 0.075, but a much smaller amount of frequencies actually being 0 compared to the other two codons. Since it is the marker in most sequences to start a protein, it follows that it would be very common throughout different genomes. Similarly, one would expect UAG to have high frequencies, but in actuality, most instances of UAG have frequencies of 0 and span between 0 and 0.005. This value might be puzzling at first, but unlike AUG which is the universal start codon, there are actually 3 possible stop codons that might differ in frequency.</p>
<div class="cell page-columns page-full">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> UAG)) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"UAG Frequency"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Usage Frequency"</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-screen-inset-shaded">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> UUA)) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"UUA Frequency"</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Usage Frequency"</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-screen-inset-shaded">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> UGA)) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"UGA Frequency"</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Usage Frequency"</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-screen-inset-shaded">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Both of the other stop codons vary from UAG. UUA seems to be the most commonly used across the data set with a frequency distribution largely between 0 and 0.05. The maximum, however, extends to just under 0.15. UGA in comparison, seems to have the majority of its frequencies at 0 with a small outgroup resting between 0.015 and 0.03.</p>
</section>
<section id="multiple-variables" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="multiple-variables">Multiple Variables</h3>
<div class="cell page-columns page-full">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Kingdom, DNAtype)) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_count</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">after_stat</span>(n), <span class="at">size =</span> <span class="fu">after_stat</span>(n))) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">'legend'</span>) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Codon Count by DNA Type and Kingdom"</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"DNA Type"</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Kingdom"</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-screen-inset-shaded">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In comparing DNAtype to Kingdom, the most common (appearing in red or reddish-purple) are genomic data in bacteria, viruses, plants, and invertebrates, and mitochondiral DNA in vertebrates. Others are scattered throughout the graph and give a good picture about what combinations are and aren’t present. For instance, there are kinetoplast samples found in at least one invertebrate sample, but there are no mitochondrial DNA samples found in phages.</p>
<div class="cell page-columns page-full">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> Ncodons)) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Kingdom) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Number of Codons in All Samples"</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Number of Codons"</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-screen-inset-shaded">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The number of codons between Kingdom categories does seem to vary. Between all groups, most have a number of codons between 1000 and 100,000, as noted in the earlier graph examining codon number alone. Among all the categories, bacteria has another notable concentration of counts between 10,000,000 and 100,000,000 codons in each sequence which is not seen in any other group.</p>
<div class="page-columns page-full">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> AUG)) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"AUG Frequency"</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Usage Frequency"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> DNAtype)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> UAG)) <span class="sc">+</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"UAG Frequency"</span>,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Usage Frequency"</span>,</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> DNAtype)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> UUA)) <span class="sc">+</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"UUA Frequency"</span>,</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Usage Frequency"</span>,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> DNAtype)</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> UGA)) <span class="sc">+</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"UGA Frequency"</span>,</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Usage Frequency"</span>,</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> DNAtype)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell column-screen-inset-shaded quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-11-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-11-4.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<p>When comparing codon frequencies between DNAtype, only mitochondrial, genomic, and chloroplast DNA are visible due to the very small number of observations in the other categories. Despite that, there are some differences visible between the categories that are present. For instance, the stop codon UUA has most of its frequencies between 0 and 0.05 in genomic DNA, between 0 and 0.03 in mitochondrial (with a smaller subset extending to 0.15), and between 0.025 and 0.05 in chloroplast DNA.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> AUG)) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"AUG Frequency"</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Usage Frequency"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Kingdom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> UAG)) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"UAG Frequency"</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Usage Frequency"</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Kingdom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> UUA)) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"UUA Frequency"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Usage Frequency"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Kingdom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-12-3.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> UGA)) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"UGA Frequency"</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Usage Frequency"</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Kingdom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-12-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>When examining codons by Kingdom, most concentrations in frequency are present across groups with different counts due to the number of observations within each group. For instance, frequencies for AUG are typically between 0.1 and 0.3, but some, like vertebrates and mammals, have a slight positive skew that sets them apart from the rest. UUA has wider variation with some groups like viruses and vertebrates having frequencies typically between 0 and 0.05 but, in comparison, the most common frequency for bacteria by a large margin is 0. Since this handful of codons have a fair amount of variation when compared across different taxa, it wouldn’t be too unexpected to see similar variation in other codons as well.</p>
<p>As a whole, it seems that codon frequencies have a good potential for predicting Kingdom in this data set. There are a wide amount of codons to incorporate in prediction models, and their occurrence seems to vary by Kingdom. The other factors present, Ncodons and DNAtype, will remain included as well since they also vary by Kingdom and might play a part in what codons are present.</p>
</section>
</section>
<section id="model-building" class="level2">
<h2 class="anchored" data-anchor-id="model-building">Model Building</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>train_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(train, <span class="at">v =</span> <span class="dv">10</span>, <span class="at">strata =</span> Kingdom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="knn" class="level3">
<h3 class="anchored" data-anchor-id="knn">KNN</h3>
<p>For the first model, I selected a KNN model. In its predictions, the model plots out observations and associates them to the same class as its neighbors. For my analysis, I expect this model to be a good benchmark for comparing other models’ metrics, but I don’t expect it to perform particularly well.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>knn_spec <span class="ot">&lt;-</span> <span class="fu">nearest_neighbor</span>() <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"kknn"</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>knn_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Kingdom <span class="sc">~</span> ., <span class="at">data =</span> train) <span class="sc">|&gt;</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rm</span>(SpeciesID, SpeciesName) <span class="sc">|&gt;</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_median</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">|&gt;</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_mode</span>(<span class="fu">all_nominal_predictors</span>()) <span class="sc">|&gt;</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_log</span>(Ncodons, <span class="at">base =</span> <span class="fu">exp</span>(<span class="dv">10</span>)) <span class="sc">|&gt;</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>())</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>knn_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(knn_spec) <span class="sc">|&gt;</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(knn_rec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Estimated time: ~30 secs</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>n_cores <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">makeCluster</span>(n_cores <span class="sc">-</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">"PSOCK"</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">registerDoParallel</span>(cl)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>()</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>knn_results <span class="ot">&lt;-</span> knn_wf <span class="sc">|&gt;</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> train_folds,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(accuracy, mn_log_loss)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>27.3 sec elapsed</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">stopImplicitCluster</span>()</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unregister</span>()</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>knn_results <span class="sc">|&gt;</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>() <span class="sc">|&gt;</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">.metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.estimator</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std_err</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.config</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">accuracy</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.9312689</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0031377</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.9619862</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.1013377</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>To my surprise, the initial metrics for this model actually turned out fairly well! Despite the high log loss at 1.01, the accuracy came out to 92.76%, which is higher than I expected.</p>
<section id="tuning" class="level4">
<h4 class="anchored" data-anchor-id="tuning">Tuning</h4>
<p>For tuning parameters, the model will be able to change <code>neighbors</code> or the amount of neighbors used to determine a new observation’s class, and <code>weight_func</code> or how distances will be computed. Since there are more than one variable, the default rectangular method will likely be surpassed by another method.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>knn_spec <span class="ot">&lt;-</span> <span class="fu">nearest_neighbor</span>(<span class="at">neighbors =</span> <span class="fu">tune</span>(), <span class="at">weight_func =</span> <span class="fu">tune</span>()) <span class="sc">|&gt;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"kknn"</span>) <span class="sc">|&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>knn_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(knn_spec) <span class="sc">|&gt;</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(knn_rec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated time: ~2 mins</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>n_cores <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">makeCluster</span>(n_cores <span class="sc">-</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">"PSOCK"</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">registerDoParallel</span>(cl)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>()</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>knn_tune_results <span class="ot">&lt;-</span> knn_wf <span class="sc">%&gt;%</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tune_grid</span>(</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> train_folds,</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(mn_log_loss),</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">initial =</span> <span class="dv">5</span>,</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid =</span> <span class="dv">15</span>,</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">control_bayes</span>(<span class="at">parallel_over =</span> <span class="st">"everything"</span>)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>109.31 sec elapsed</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">stopImplicitCluster</span>()</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unregister</span>()</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>knn_tune_results <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>() <span class="sc">|&gt;</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">neighbors</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">weight_func</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.estimator</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std_err</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.config</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">biweight</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.9691811</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.1031640</td>
<td style="text-align: left;">Preprocessor1_Model01</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: left;">biweight</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.6688016</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0862041</td>
<td style="text-align: left;">Preprocessor1_Model02</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">cos</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.6330670</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.1127930</td>
<td style="text-align: left;">Preprocessor1_Model03</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: left;">cos</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.5015929</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0654022</td>
<td style="text-align: left;">Preprocessor1_Model04</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: left;">epanechnikov</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.8843835</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.1011842</td>
<td style="text-align: left;">Preprocessor1_Model05</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: left;">epanechnikov</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.6300626</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0741907</td>
<td style="text-align: left;">Preprocessor1_Model06</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">rectangular</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">2.4773209</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.1130941</td>
<td style="text-align: left;">Preprocessor1_Model07</td>
</tr>
<tr class="even">
<td style="text-align: right;">11</td>
<td style="text-align: left;">rectangular</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.6524660</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0681644</td>
<td style="text-align: left;">Preprocessor1_Model08</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: left;">triangular</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.7081188</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0865719</td>
<td style="text-align: left;">Preprocessor1_Model09</td>
</tr>
<tr class="even">
<td style="text-align: right;">15</td>
<td style="text-align: left;">triangular</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.4714142</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0644546</td>
<td style="text-align: left;">Preprocessor1_Model10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: left;">triweight</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.1503674</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.1181274</td>
<td style="text-align: left;">Preprocessor1_Model11</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: left;">triweight</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.5530452</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0666896</td>
<td style="text-align: left;">Preprocessor1_Model12</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td style="text-align: left;">gaussian</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.5243278</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0657151</td>
<td style="text-align: left;">Preprocessor1_Model13</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: left;">inv</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.3011734</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.1305702</td>
<td style="text-align: left;">Preprocessor1_Model14</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: left;">rank</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.8044119</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0969632</td>
<td style="text-align: left;">Preprocessor1_Model15</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="fitting" class="level4">
<h4 class="anchored" data-anchor-id="fitting">Fitting</h4>
<p>Next, I’ll take the best performing parameters and use them to make a final version of the model then fit it to the training data.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>knn_best_params <span class="ot">&lt;-</span> knn_tune_results <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_best</span>(<span class="at">metric =</span> <span class="st">"mn_log_loss"</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>knn_best_wf <span class="ot">&lt;-</span> knn_wf <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(knn_best_params)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>knn_best_fit <span class="ot">&lt;-</span> knn_best_wf <span class="sc">%&gt;%</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, we’ll test the model against the training data:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>knn_log_loss <span class="ot">&lt;-</span> knn_best_fit <span class="sc">|&gt;</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(train) <span class="sc">|&gt;</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Kingdom =</span> <span class="fu">as.factor</span>(Kingdom)) <span class="sc">|&gt;</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mn_log_loss</span>(Kingdom, <span class="fu">starts_with</span>(<span class="st">".pred"</span>), <span class="sc">-</span> .pred_class)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>knn_accuracy_metric <span class="ot">&lt;-</span> knn_best_fit <span class="sc">|&gt;</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(train) <span class="sc">|&gt;</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Kingdom =</span> <span class="fu">as.factor</span>(Kingdom)) <span class="sc">|&gt;</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>(Kingdom, .pred_class)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>knn_log_loss <span class="sc">|&gt;</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(knn_accuracy_metric) <span class="sc">|&gt;</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">.metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.estimator</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.0589955</td>
</tr>
<tr class="even">
<td style="text-align: left;">accuracy</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.9964172</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>As shown by these metrics, the tuned version of the knn model heavily improved upon the initial metrics. The accuracy of the predictions is at 99.64% and the log loss is down to 0.06, implying that the model is both predicting correctly the majority of the time and also very certain about those predictions. However, these metrics were from the data fit to the same data its predicting, so these good metrics may be because of some overfitting.</p>
<p>To further test the knn model, I used the fitted model against the test data that was set aside at the beginning of the analysis and see how the model handles data it hasn’t seen before.</p>
</section>
<section id="testing" class="level4">
<h4 class="anchored" data-anchor-id="testing">Testing</h4>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>knn_log_loss <span class="ot">&lt;-</span> knn_best_fit <span class="sc">|&gt;</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(test) <span class="sc">|&gt;</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Kingdom =</span> <span class="fu">as.factor</span>(Kingdom)) <span class="sc">|&gt;</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mn_log_loss</span>(Kingdom, <span class="fu">starts_with</span>(<span class="st">".pred"</span>), <span class="sc">-</span> .pred_class)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>knn_accuracy_metric <span class="ot">&lt;-</span> knn_best_fit <span class="sc">|&gt;</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(test) <span class="sc">|&gt;</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Kingdom =</span> <span class="fu">as.factor</span>(Kingdom)) <span class="sc">|&gt;</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>(Kingdom, .pred_class)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>knn_log_loss <span class="sc">|&gt;</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(knn_accuracy_metric) <span class="sc">|&gt;</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">.metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.estimator</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.4718750</td>
</tr>
<tr class="even">
<td style="text-align: left;">accuracy</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.9312673</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>When given the test data, the tuned knn model performed very well. The accuracy was 93.13% and the log loss value was 0.47. Although not as confident as it was with the training data, it still retained a high accuracy with modest confidence in its predictions.</p>
</section>
</section>
<section id="dt" class="level3">
<h3 class="anchored" data-anchor-id="dt">DT</h3>
<p>In comparison to the KNN model, I expect the decision tree to have more difficulty in assessing individual codon frequencies and accurately predicting the the Kingdom categories from there. While the KNN model can compare individual data points along multiple axis (through multi-dimensional spaces, in many iterations), the tree structure might be a limitation in how the model “thinks” through its predictions; numeric values in particular are limited to certain ranges with the model “asking” if a given range is at or below a certain threshold.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>dt_spec <span class="ot">&lt;-</span> <span class="fu">decision_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"rpart"</span>) <span class="sc">|&gt;</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>dt_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Kingdom <span class="sc">~</span> ., <span class="at">data =</span> train) <span class="sc">|&gt;</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rm</span>(SpeciesID, SpeciesName) <span class="sc">|&gt;</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_median</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">|&gt;</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_mode</span>(<span class="fu">all_nominal_predictors</span>())<span class="sc">|&gt;</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_log</span>(Ncodons, <span class="at">base =</span> <span class="fu">exp</span>(<span class="dv">10</span>)) <span class="sc">|&gt;</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>())</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>dt_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(dt_spec) <span class="sc">|&gt;</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(dt_rec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Elapsed time in RStudio: ~25 secs</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>n_cores <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">makeCluster</span>(n_cores <span class="sc">-</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">"PSOCK"</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">registerDoParallel</span>(cl)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>()</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>dt_results <span class="ot">&lt;-</span> dt_wf <span class="sc">|&gt;</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> train_folds,</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(accuracy, mn_log_loss)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>23.97 sec elapsed</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">stopImplicitCluster</span>()</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unregister</span>()</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>dt_results <span class="sc">|&gt;</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>() <span class="sc">|&gt;</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">.metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.estimator</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std_err</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.config</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">accuracy</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.6527796</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0072464</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.1450647</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0165512</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Based on these first metrics, it seems like the decision tree model is performing worse than the knn model. Here, the accuracy is 65.28% while the log loss is 1.43. With some tuning, there might be some improvement.</p>
<section id="tuning-1" class="level4">
<h4 class="anchored" data-anchor-id="tuning-1">Tuning</h4>
<p>For tuned parameters, this decision tree model has <code>min_n</code> or the minimum number of observations required to split a node, <code>tree_depth</code> or the maximum number of splits from the root to the tip of the tree, and <code>cost_complexity</code>or how much it “costs” the model to split a node further and extend the tree.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>dt_spec <span class="ot">&lt;-</span> <span class="fu">decision_tree</span>(<span class="at">min_n =</span> <span class="fu">tune</span>(), <span class="at">tree_depth =</span> <span class="fu">tune</span>(), <span class="at">cost_complexity =</span> <span class="fu">tune</span>()) <span class="sc">|&gt;</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"rpart"</span>) <span class="sc">|&gt;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>dt_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(dt_spec) <span class="sc">|&gt;</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(dt_rec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Elapsed time in RStudio: ~1 min</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>n_cores <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">makeCluster</span>(n_cores <span class="sc">-</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">"PSOCK"</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">registerDoParallel</span>(cl)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>()</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>dt_tune_results <span class="ot">&lt;-</span> dt_wf <span class="sc">%&gt;%</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tune_grid</span>(</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> train_folds,</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(mn_log_loss),</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">initial =</span> <span class="dv">5</span>,</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid =</span> <span class="dv">15</span>,</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">control_bayes</span>(<span class="at">parallel_over =</span> <span class="st">"everything"</span>)</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>62.01 sec elapsed</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">stopImplicitCluster</span>()</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unregister</span>()</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>dt_tune_results <span class="sc">%&gt;%</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>() <span class="sc">|&gt;</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">cost_complexity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">tree_depth</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">min_n</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.estimator</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std_err</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.config</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">23</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.153510</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0307017</td>
<td style="text-align: left;">Preprocessor1_Model01</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">2.043498</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.1197674</td>
<td style="text-align: left;">Preprocessor1_Model02</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">3.816036</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0862078</td>
<td style="text-align: left;">Preprocessor1_Model03</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.173737</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0308019</td>
<td style="text-align: left;">Preprocessor1_Model04</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">37</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.209816</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0225846</td>
<td style="text-align: left;">Preprocessor1_Model05</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0000002</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">18</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.597445</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0084695</td>
<td style="text-align: left;">Preprocessor1_Model06</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0000007</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">40</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.590040</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0608783</td>
<td style="text-align: left;">Preprocessor1_Model07</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0000032</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">21</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.438011</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0568340</td>
<td style="text-align: left;">Preprocessor1_Model08</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0000139</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">5.180628</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.1121364</td>
<td style="text-align: left;">Preprocessor1_Model09</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0000611</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">26</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">2.238878</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.1263500</td>
<td style="text-align: left;">Preprocessor1_Model10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0002683</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.315625</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0366001</td>
<td style="text-align: left;">Preprocessor1_Model11</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0011788</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">31</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.296076</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0138242</td>
<td style="text-align: left;">Preprocessor1_Model12</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0051795</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.429707</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0087858</td>
<td style="text-align: left;">Preprocessor1_Model13</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0227585</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">34</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.352175</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0229589</td>
<td style="text-align: left;">Preprocessor1_Model14</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.1000000</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.468895</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0086543</td>
<td style="text-align: left;">Preprocessor1_Model15</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="fitting-1" class="level4">
<h4 class="anchored" data-anchor-id="fitting-1">Fitting</h4>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>dt_best_params <span class="ot">&lt;-</span> dt_tune_results <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_best</span>(<span class="at">metric =</span> <span class="st">"mn_log_loss"</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>dt_best_wf <span class="ot">&lt;-</span> dt_wf <span class="sc">%&gt;%</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(dt_best_params)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>dt_best_fit <span class="ot">&lt;-</span> dt_best_wf <span class="sc">%&gt;%</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>After fitting the data, the tree can be visualized with the following code to see how the model is processing each observation.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>dt_best_fit <span class="sc">|&gt;</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">|&gt;</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(<span class="at">box.palette =</span> <span class="fu">list</span>(<span class="st">"Purples"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Cannot retrieve the data used to build the model (model.frame: object '..y' not found).
To silence this warning:
    Call rpart.plot with roundint=FALSE,
    or rebuild the rpart model with model=TRUE.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: labs do not fit even at cex 0.15, there may be some overplotting</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FinalProject_files/figure-html/dt%20plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Based on this plot, it seems that the model has to perform a lot of subdivisions to satisfyingly divide observations into each Kingdom. This might be part of why the model is not performing as well as the KNN model so far; the arrangement of this data may not be suited to a simple decision tree model.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>dt_log_loss <span class="ot">&lt;-</span> dt_best_fit <span class="sc">|&gt;</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(train) <span class="sc">|&gt;</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Kingdom =</span> <span class="fu">as.factor</span>(Kingdom)) <span class="sc">|&gt;</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mn_log_loss</span>(Kingdom, <span class="fu">starts_with</span>(<span class="st">".pred"</span>), <span class="sc">-</span> .pred_class)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>dt_accuracy_metric <span class="ot">&lt;-</span> dt_best_fit <span class="sc">|&gt;</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(train) <span class="sc">|&gt;</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Kingdom =</span> <span class="fu">as.factor</span>(Kingdom)) <span class="sc">|&gt;</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>(Kingdom, .pred_class)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>dt_log_loss <span class="sc">|&gt;</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(dt_accuracy_metric) <span class="sc">|&gt;</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">.metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.estimator</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.8828939</td>
</tr>
<tr class="even">
<td style="text-align: left;">accuracy</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.7039615</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Once tuned &amp; fit, the model performs a fair bit better compared to the initial un-tuned version. The accuracy is now 88.29% and the log loss is 0.70. While not as good as the knn model’s metrics, these results are a good improvement from the initial metrics.</p>
</section>
<section id="testing-1" class="level4">
<h4 class="anchored" data-anchor-id="testing-1">Testing</h4>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>dt_log_loss <span class="ot">&lt;-</span> dt_best_fit <span class="sc">|&gt;</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(test) <span class="sc">|&gt;</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Kingdom =</span> <span class="fu">as.factor</span>(Kingdom)) <span class="sc">|&gt;</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mn_log_loss</span>(Kingdom, <span class="fu">starts_with</span>(<span class="st">".pred"</span>), <span class="sc">-</span> .pred_class)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>dt_accuracy_metric <span class="ot">&lt;-</span> dt_best_fit <span class="sc">|&gt;</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(test) <span class="sc">|&gt;</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Kingdom =</span> <span class="fu">as.factor</span>(Kingdom)) <span class="sc">|&gt;</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>(Kingdom, .pred_class)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>dt_log_loss <span class="sc">|&gt;</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(dt_accuracy_metric) <span class="sc">|&gt;</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">.metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.estimator</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.1509513</td>
</tr>
<tr class="even">
<td style="text-align: left;">accuracy</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.6799632</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Once introduced to the test data, as expected, the results are not as good as the training data. The accuracy has gone down to 68.00% while the log loss has increased to 1.15, meaning the model is both less accurate with its predictions on the test data and less confident about its “choices”.</p>
<p>Overall, the decison tree model does not appear to be a good fit for this data. Between it and the knn model, the knn model is highly preferred.</p>
</section>
</section>
<section id="random-trees" class="level3">
<h3 class="anchored" data-anchor-id="random-trees">Random Trees</h3>
<p>As another attempt, I wanted to see if a tree ensemble would perform significantly better than a single tree. This model, a random forest, will use many iterations of trees to make its predictions instead of a single instance. I anticipate that it will perform better than the single decision tree, but I’m not sure if it will surpase the KNN model’s performance.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>rf_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>() <span class="sc">|&gt;</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"ranger"</span>) <span class="sc">|&gt;</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>rf_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Kingdom <span class="sc">~</span> ., <span class="at">data =</span> train) <span class="sc">|&gt;</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rm</span>(SpeciesID, SpeciesName) <span class="sc">|&gt;</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_median</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">|&gt;</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_mode</span>(<span class="fu">all_nominal_predictors</span>())<span class="sc">|&gt;</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_log</span>(Ncodons, <span class="at">base =</span> <span class="fu">exp</span>(<span class="dv">10</span>)) <span class="sc">|&gt;</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>())</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>rf_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(rf_spec) <span class="sc">|&gt;</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(rf_rec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Elapsed time in RStudio: ~45 secs</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>n_cores <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">makeCluster</span>(n_cores <span class="sc">-</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">"PSOCK"</span>)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">registerDoParallel</span>(cl)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>()</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>rf_results <span class="ot">&lt;-</span> rf_wf <span class="sc">|&gt;</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> train_folds,</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(accuracy, mn_log_loss)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>46.13 sec elapsed</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">stopImplicitCluster</span>()</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unregister</span>()</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>rf_results <span class="sc">|&gt;</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>() <span class="sc">|&gt;</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">.metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.estimator</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std_err</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.config</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">accuracy</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.8920090</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0029814</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.4883703</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0076379</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>From the initial metrics, this model is definitely performing better than the single decision tree with an accuracy of 89.08% and a log loss of 0.49. While the accuracy isn’t as high as the knn model, the log loss is a lot lower. From here, a tuned random forest may prove to be very effective.</p>
<section id="tuning-2" class="level4">
<h4 class="anchored" data-anchor-id="tuning-2">Tuning</h4>
<p>For this model, the parameters to be tuned are <code>trees</code> or the number of trees included within the forest and <code>min_n</code> or the number of nodes required to split a tree.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>rf_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>(<span class="at">trees =</span> <span class="fu">tune</span>(), <span class="at">min_n =</span> <span class="fu">tune</span>()) <span class="sc">|&gt;</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"ranger"</span>) <span class="sc">|&gt;</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>rf_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(rf_spec) <span class="sc">|&gt;</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(rf_rec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Elapsed time in RStudio: ~11 mins</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>n_cores <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">makeCluster</span>(n_cores <span class="sc">-</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">"PSOCK"</span>)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">registerDoParallel</span>(cl)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>()</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>rf_tune_results <span class="ot">&lt;-</span> rf_wf <span class="sc">%&gt;%</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tune_grid</span>(</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> train_folds,</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(mn_log_loss),</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">initial =</span> <span class="dv">5</span>,</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid =</span> <span class="dv">15</span>,</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">control_bayes</span>(<span class="at">parallel_over =</span> <span class="st">"everything"</span>)</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>668.94 sec elapsed</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">stopImplicitCluster</span>()</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unregister</span>()</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>rf_tune_results <span class="sc">%&gt;%</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>() <span class="sc">|&gt;</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">trees</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">min_n</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.estimator</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std_err</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.config</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">5.4546480</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.1416663</td>
<td style="text-align: left;">Preprocessor1_Model01</td>
</tr>
<tr class="even">
<td style="text-align: right;">143</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.4931577</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0069843</td>
<td style="text-align: left;">Preprocessor1_Model02</td>
</tr>
<tr class="odd">
<td style="text-align: right;">286</td>
<td style="text-align: right;">21</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.5192235</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0077927</td>
<td style="text-align: left;">Preprocessor1_Model03</td>
</tr>
<tr class="even">
<td style="text-align: right;">429</td>
<td style="text-align: right;">37</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.5587230</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0080929</td>
<td style="text-align: left;">Preprocessor1_Model04</td>
</tr>
<tr class="odd">
<td style="text-align: right;">572</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.4639001</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0073564</td>
<td style="text-align: left;">Preprocessor1_Model05</td>
</tr>
<tr class="even">
<td style="text-align: right;">714</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.4941445</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0075496</td>
<td style="text-align: left;">Preprocessor1_Model06</td>
</tr>
<tr class="odd">
<td style="text-align: right;">857</td>
<td style="text-align: right;">23</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.5249453</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0075593</td>
<td style="text-align: left;">Preprocessor1_Model07</td>
</tr>
<tr class="even">
<td style="text-align: right;">1000</td>
<td style="text-align: right;">34</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.5508439</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0078014</td>
<td style="text-align: left;">Preprocessor1_Model08</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1143</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.4688896</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0075042</td>
<td style="text-align: left;">Preprocessor1_Model09</td>
</tr>
<tr class="even">
<td style="text-align: right;">1286</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.5022902</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0075344</td>
<td style="text-align: left;">Preprocessor1_Model10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1428</td>
<td style="text-align: right;">26</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.5322896</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0078365</td>
<td style="text-align: left;">Preprocessor1_Model11</td>
</tr>
<tr class="even">
<td style="text-align: right;">1571</td>
<td style="text-align: right;">40</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.5632295</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0079478</td>
<td style="text-align: left;">Preprocessor1_Model12</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1714</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.4778023</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0074555</td>
<td style="text-align: left;">Preprocessor1_Model13</td>
</tr>
<tr class="even">
<td style="text-align: right;">1857</td>
<td style="text-align: right;">18</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.5111382</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0075782</td>
<td style="text-align: left;">Preprocessor1_Model14</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2000</td>
<td style="text-align: right;">31</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.5440214</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0076785</td>
<td style="text-align: left;">Preprocessor1_Model15</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="fitting-2" class="level4">
<h4 class="anchored" data-anchor-id="fitting-2">Fitting</h4>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>rf_best_params <span class="ot">&lt;-</span> rf_tune_results <span class="sc">%&gt;%</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_best</span>(<span class="at">metric =</span> <span class="st">"mn_log_loss"</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>rf_best_wf <span class="ot">&lt;-</span> rf_wf <span class="sc">%&gt;%</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(rf_best_params)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>rf_best_fit <span class="ot">&lt;-</span> rf_best_wf <span class="sc">%&gt;%</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>rf_log_loss <span class="ot">&lt;-</span> rf_best_fit <span class="sc">|&gt;</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(train) <span class="sc">|&gt;</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Kingdom =</span> <span class="fu">as.factor</span>(Kingdom)) <span class="sc">|&gt;</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mn_log_loss</span>(Kingdom, <span class="fu">starts_with</span>(<span class="st">".pred"</span>), <span class="sc">-</span> .pred_class)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>rf_accuracy_metric <span class="ot">&lt;-</span> rf_best_fit <span class="sc">|&gt;</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(train) <span class="sc">|&gt;</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Kingdom =</span> <span class="fu">as.factor</span>(Kingdom)) <span class="sc">|&gt;</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>(Kingdom, .pred_class)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>rf_log_loss <span class="sc">|&gt;</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(rf_accuracy_metric) <span class="sc">|&gt;</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">.metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.estimator</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.1298039</td>
</tr>
<tr class="even">
<td style="text-align: left;">accuracy</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.0000000</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>After tuning and fitting the model to the test data, the random forest model got an accuracy score of 100% and a log loss of 0.13. Compared to both the other models in this analysis and my previous projects, this is one of the best performances I’ve seen! Having such a high accuracy rating with that level of confidence is a very good sign for the usefulness of this model</p>
<p>Let’s see how the fit model fairs with the test data before reaching any conclusions.</p>
</section>
<section id="testing-2" class="level4">
<h4 class="anchored" data-anchor-id="testing-2">Testing</h4>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>rf_log_loss <span class="ot">&lt;-</span> rf_best_fit <span class="sc">|&gt;</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(test) <span class="sc">|&gt;</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Kingdom =</span> <span class="fu">as.factor</span>(Kingdom)) <span class="sc">|&gt;</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mn_log_loss</span>(Kingdom, <span class="fu">starts_with</span>(<span class="st">".pred"</span>), <span class="sc">-</span> .pred_class)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>rf_accuracy_metric <span class="ot">&lt;-</span> rf_best_fit <span class="sc">|&gt;</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(test) <span class="sc">|&gt;</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Kingdom =</span> <span class="fu">as.factor</span>(Kingdom)) <span class="sc">|&gt;</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>(Kingdom, .pred_class)</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>rf_log_loss <span class="sc">|&gt;</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(rf_accuracy_metric) <span class="sc">|&gt;</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">.metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.estimator</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.4476946</td>
</tr>
<tr class="even">
<td style="text-align: left;">accuracy</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.9094814</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Even with unfamiliar data, this model still performs very well. The accuracy is 90.80% and the log loss is 0.46. This figure is actually fairly similar to the tested knn model since it had an accuracy of 93.13% and a log loss of 0.47. Since the models are comparable, the preferance in using one or the other might rest on computation time since the knn model is much faster.</p>
</section>
</section>
<section id="support-vector-machine-model" class="level3">
<h3 class="anchored" data-anchor-id="support-vector-machine-model">Support Vector Machine Model</h3>
<p>As a fourth model, I wanted to test a support vector machine model. It works a bit like the knn model, but instead of directly comparing an observation to neighbors, the model creates boundaries between groups to delineate classifications. In this case, I used a <code>svm_poly()</code> function to account for non-linear divisions of observations. Since I haven’t used this model as much as the others, I’m not sure how it will perform, especially when tuned.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>svm_spec <span class="ot">&lt;-</span> <span class="fu">svm_poly</span>() <span class="sc">|&gt;</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"kernlab"</span>) <span class="sc">|&gt;</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>svm_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Kingdom <span class="sc">~</span> ., <span class="at">data =</span> train) <span class="sc">|&gt;</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rm</span>(SpeciesID, SpeciesName) <span class="sc">|&gt;</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_median</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">|&gt;</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_mode</span>(<span class="fu">all_nominal_predictors</span>()) <span class="sc">|&gt;</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_log</span>(Ncodons, <span class="at">base =</span> <span class="fu">exp</span>(<span class="dv">10</span>)) <span class="sc">|&gt;</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>())</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>svm_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(svm_spec) <span class="sc">|&gt;</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(svm_rec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Estimated time: ~1 min</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>n_cores <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">makeCluster</span>(n_cores <span class="sc">-</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">"PSOCK"</span>)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">registerDoParallel</span>(cl)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>()</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>svm_results <span class="ot">&lt;-</span> svm_wf <span class="sc">|&gt;</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> train_folds,</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(accuracy, mn_log_loss)</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>46.19 sec elapsed</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">stopImplicitCluster</span>()</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unregister</span>()</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>svm_results <span class="sc">|&gt;</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>() <span class="sc">|&gt;</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">.metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.estimator</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std_err</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.config</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">accuracy</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.8909063</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0032329</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.5713721</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0128307</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>As a initial untuned model, the metrics here are ok but not great. The accuracy is 88.96% but the log loss is 1.57, the highest we’ve seen so far. Despite the good accuracy, it seems that this model is uncertain in its predictions. Maybe some tuning will assist in raising its confidence.</p>
<section id="tuning-3" class="level4">
<h4 class="anchored" data-anchor-id="tuning-3">Tuning</h4>
<p>The parameters available for tuning on this model are <code>cost</code> or the penalty for placing an observation within a margin of separation, <code>degree</code> or the degree of the polynomial used, and <code>scale_factor</code> or a number used to scale the polynomial.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>svm_spec <span class="ot">&lt;-</span> <span class="fu">svm_poly</span>(<span class="at">cost =</span> <span class="fu">tune</span>(), <span class="at">degree =</span> <span class="fu">tune</span>(), <span class="at">scale_factor =</span> <span class="fu">tune</span>()) <span class="sc">|&gt;</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"kernlab"</span>) <span class="sc">|&gt;</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>svm_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(svm_spec) <span class="sc">|&gt;</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(svm_rec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Elapsed time in RStudio: ~16 mins</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>n_cores <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">makeCluster</span>(n_cores <span class="sc">-</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">"PSOCK"</span>)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">registerDoParallel</span>(cl)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>()</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>svm_tune_results <span class="ot">&lt;-</span> svm_wf <span class="sc">%&gt;%</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tune_grid</span>(</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> train_folds,</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(mn_log_loss),</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">initial =</span> <span class="dv">5</span>,</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid =</span> <span class="dv">15</span>,</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">control_bayes</span>(<span class="at">parallel_over =</span> <span class="st">"everything"</span>)</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>909.12 sec elapsed</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">stopImplicitCluster</span>()</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unregister</span>()</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>svm_tune_results <span class="sc">%&gt;%</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>() <span class="sc">|&gt;</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">cost</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">degree</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">scale_factor</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.estimator</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std_err</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.config</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0009766</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0000139</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.917799</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0092782</td>
<td style="text-align: left;">Preprocessor1_Model01</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0020523</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.0002683</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.784418</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0129086</td>
<td style="text-align: left;">Preprocessor1_Model02</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0043128</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">2.089794</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0044331</td>
<td style="text-align: left;">Preprocessor1_Model03</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0090635</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">2.089954</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0044331</td>
<td style="text-align: left;">Preprocessor1_Model04</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0190471</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0227585</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.618324</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0064407</td>
<td style="text-align: left;">Preprocessor1_Model05</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0400277</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0000007</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.926980</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0078891</td>
<td style="text-align: left;">Preprocessor1_Model06</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0841188</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.1000000</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.582868</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0098273</td>
<td style="text-align: left;">Preprocessor1_Model07</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.1767767</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0000032</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.794832</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0132370</td>
<td style="text-align: left;">Preprocessor1_Model08</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.3714986</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">2.042089</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0044580</td>
<td style="text-align: left;">Preprocessor1_Model09</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.7807092</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.0000611</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.643778</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0072429</td>
<td style="text-align: left;">Preprocessor1_Model10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.6406707</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">2.088514</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0044351</td>
<td style="text-align: left;">Preprocessor1_Model11</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.4478913</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0011788</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.593095</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0120552</td>
<td style="text-align: left;">Preprocessor1_Model12</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.2457893</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.842264</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0149985</td>
<td style="text-align: left;">Preprocessor1_Model13</td>
</tr>
<tr class="even">
<td style="text-align: right;">15.2271224</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0051795</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.545550</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0109824</td>
<td style="text-align: left;">Preprocessor1_Model14</td>
</tr>
<tr class="odd">
<td style="text-align: right;">32.0000000</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0000002</td>
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.754688</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0115939</td>
<td style="text-align: left;">Preprocessor1_Model15</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="fitting-3" class="level4">
<h4 class="anchored" data-anchor-id="fitting-3">Fitting</h4>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>svm_best_params <span class="ot">&lt;-</span> svm_tune_results <span class="sc">%&gt;%</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_best</span>(<span class="at">metric =</span> <span class="st">"mn_log_loss"</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>svm_best_wf <span class="ot">&lt;-</span> svm_wf <span class="sc">%&gt;%</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(svm_best_params)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>svm_best_fit <span class="ot">&lt;-</span> svm_best_wf <span class="sc">%&gt;%</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>svm_log_loss <span class="ot">&lt;-</span> svm_best_fit <span class="sc">|&gt;</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(train) <span class="sc">|&gt;</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Kingdom =</span> <span class="fu">as.factor</span>(Kingdom)) <span class="sc">|&gt;</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mn_log_loss</span>(Kingdom, <span class="fu">starts_with</span>(<span class="st">".pred"</span>), <span class="sc">-</span> .pred_class)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>svm_accuracy_metric <span class="ot">&lt;-</span> svm_best_fit <span class="sc">|&gt;</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(train) <span class="sc">|&gt;</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Kingdom =</span> <span class="fu">as.factor</span>(Kingdom)) <span class="sc">|&gt;</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>(Kingdom, .pred_class)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>svm_log_loss <span class="sc">|&gt;</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(svm_accuracy_metric) <span class="sc">|&gt;</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">.metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.estimator</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.4932881</td>
</tr>
<tr class="even">
<td style="text-align: left;">accuracy</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.9707237</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Once tuned, the model does feature a good accuracy score of 97.07%. However, the log loss remains very high at 1.50, the highest for any tuned model so far.</p>
</section>
<section id="testing-3" class="level4">
<h4 class="anchored" data-anchor-id="testing-3">Testing</h4>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>svm_log_loss <span class="ot">&lt;-</span> svm_best_fit <span class="sc">|&gt;</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(test) <span class="sc">|&gt;</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Kingdom =</span> <span class="fu">as.factor</span>(Kingdom)) <span class="sc">|&gt;</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mn_log_loss</span>(Kingdom, <span class="fu">starts_with</span>(<span class="st">".pred"</span>), <span class="sc">-</span> .pred_class)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>svm_accuracy_metric <span class="ot">&lt;-</span> svm_best_fit <span class="sc">|&gt;</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(test) <span class="sc">|&gt;</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Kingdom =</span> <span class="fu">as.factor</span>(Kingdom)) <span class="sc">|&gt;</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>(Kingdom, .pred_class)</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>svm_log_loss <span class="sc">|&gt;</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(svm_accuracy_metric) <span class="sc">|&gt;</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">.metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.estimator</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mn_log_loss</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">1.5487406</td>
</tr>
<tr class="even">
<td style="text-align: left;">accuracy</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.9309604</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Lastly, the fitted model against the test data has an accuracy of 93.10% and a log loss of 1.55. Again, despite the great accuracy, the log loss remains high and signals the lack of confidence the model has in its predictions. Compared to the rest of the model, this support vector model has similar accuracy but falls short in its log loss metrics.</p>
</section>
</section>
</section>
<section id="conclusions" class="level2">
<h2 class="anchored" data-anchor-id="conclusions">Conclusions</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>model_metrics <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="fu">c</span>(<span class="st">"knn"</span>, <span class="st">"dt"</span>, <span class="st">"rf"</span>, <span class="st">"svm"</span>),</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">initial_accuracy =</span> <span class="fu">c</span>(<span class="fl">0.9276</span>, <span class="fl">0.6528</span>, <span class="fl">0.8914</span>, <span class="fl">0.8909</span>),</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">initial_log_loss =</span> <span class="fu">c</span>(<span class="fl">1.01</span>, <span class="fl">1.15</span>, <span class="fl">0.48</span>, <span class="fl">1.57</span>),</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuned_accuracy =</span> <span class="fu">c</span>(<span class="fl">0.9964</span>, <span class="fl">0.8829</span>, <span class="fl">1.0000</span>, <span class="fl">0.9707</span>),</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuned_log_loss =</span> <span class="fu">c</span>(<span class="fl">0.06</span>, <span class="fl">0.70</span>, <span class="fl">0.13</span>, <span class="fl">1.50</span>),</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">tested_accuracy =</span> <span class="fu">c</span>(<span class="fl">0.9313</span>, <span class="fl">0.6800</span>, <span class="fl">0.9052</span>, <span class="fl">0.9310</span>),</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">tested_log_loss =</span> <span class="fu">c</span>(<span class="fl">0.47</span>, <span class="fl">1.15</span>, <span class="fl">0.46</span>, <span class="fl">1.55</span>),</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimated_tuning_time =</span> <span class="fu">c</span>(<span class="dv">120</span>, <span class="dv">60</span>, <span class="dv">660</span>, <span class="dv">960</span>)</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>model_metrics <span class="sc">|&gt;</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">model</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">initial_accuracy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">initial_log_loss</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">tuned_accuracy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">tuned_log_loss</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">tested_accuracy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">tested_log_loss</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimated_tuning_time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">knn</td>
<td style="text-align: right;">0.9276</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">0.9964</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.9313</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">120</td>
</tr>
<tr class="even">
<td style="text-align: left;">dt</td>
<td style="text-align: right;">0.6528</td>
<td style="text-align: right;">1.15</td>
<td style="text-align: right;">0.8829</td>
<td style="text-align: right;">0.70</td>
<td style="text-align: right;">0.6800</td>
<td style="text-align: right;">1.15</td>
<td style="text-align: right;">60</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rf</td>
<td style="text-align: right;">0.8914</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">1.0000</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.9052</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">660</td>
</tr>
<tr class="even">
<td style="text-align: left;">svm</td>
<td style="text-align: right;">0.8909</td>
<td style="text-align: right;">1.57</td>
<td style="text-align: right;">0.9707</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">0.9310</td>
<td style="text-align: right;">1.55</td>
<td style="text-align: right;">960</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Overall, it seems that Kingdom within the data set can be reliably predicted through a number of models. To my surprise, many of their iterations performed extremely well and obtained scores in the 80% to 100% range. Most notably, the tuned Random Forest model had an accuracy of 100% with a vanishingly small log loss (only 0.13)! The worst performing models in this analysis was the single decision tree; it had the lowest accuracy scores of all the models included and some of the highest log loss values. Next was the support vector model. Despite the accuracy scores it achieved, its log loss scores were the highest out of all models at every iteration. Lastly, the random forest and knn models performed very similarly. Both had high accuracy scores and low log loss scores across the board, and both models scored within a few points of each other in all iterations besides the initial log loss in untuned models. It seems like either model works well for predicting Kingdom, and one’s preference on relying on one over the other might be due to computation time instead since the knn model can be tuned in a fraction of the time compared to tuning a random forest model.</p>
<p>Overall, it seems that predicting taxa by codon data is not only possible but reliable; two different models were produced that performed well on both training and testing data. From this point, further work could be done to identify which codons contribute most strongly to classification and use that information to chart out how it differs across taxa. By tracing how it changes across different groups, one could use it to infer an evolutionary history of the codon and its usage. Additionally, one could incorporate gene data to illustrate what genes a certain codon is associated with and map out a gene tree to find similarities between the inferred codon history and the known evolutionary path of the gene.</p>

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-openstax" class="csl-entry" role="listitem">
Clark, Mary Ann, Matthew Douglas, and Jung Choi. 2018. <span>“Biology 2e.”</span> Openstax. 2018. <a href="https://openstax.org/books/biology-2e/pages/15-1-the-genetic-code">https://openstax.org/books/biology-2e/pages/15-1-the-genetic-code</a>.
</div>
<div id="ref-kinetoplast" class="csl-entry" role="listitem">
Parada, Laura Vegas. 2010a. <span>“Kinetoplastids and Their Networks of Interlocked DNA.”</span> Nature Education. 2010. <a href="https://www.nature.com/scitable/topicpage/kinetoplastids-and-their-networks-of-interlocked-dna-14368046">https://www.nature.com/scitable/topicpage/kinetoplastids-and-their-networks-of-interlocked-dna-14368046</a>.
</div>
<div id="ref-apicoplast" class="csl-entry" role="listitem">
———. 2010b. <span>“The Apicoplast: An Organelle with a Green Past.”</span> Nature Education. 2010. <a href="https://www.nature.com/scitable/topicpage/the-apicoplast-an-organelle-with-a-green-14231555">https://www.nature.com/scitable/topicpage/the-apicoplast-an-organelle-with-a-green-14231555</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>